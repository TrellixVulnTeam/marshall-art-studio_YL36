<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="API Guides|Upload Writer Programming">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Upload Message Mapper</title>
        <link href="../../../Resources/TableStyles/Example Table.css" rel="stylesheet" />
        <link href="../../../Resources/TableStyles/Basic Table Type.css" rel="stylesheet" />
        <link href="../../../Resources/TableStyles/Note Table.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/NewStylesheet.css" rel="stylesheet" />
        <style>/*&lt;meta /&gt;*/

.button.previous-topic-button
{
	-pie-background: #f7f7f8 url('file://vmware-host/Shared Folders/Documents/My Projects/AgencyPortal 5.0/Output/Jami_Delia/Online Output/Website Output/Skins/Default/Stylesheets/Images/left-arrow.png') no-repeat center center;
}

.button.current-topic-index-button
{
	-pie-background: linear-gradient(#ffffff, #ffffff);
}

.button.next-topic-button
{
	-pie-background: #f7f7f8 url('file://vmware-host/Shared Folders/Documents/My Projects/AgencyPortal 5.0/Output/Jami_Delia/Online Output/Website Output/Skins/Default/Stylesheets/Images/right-arrow.png') no-repeat center center;
}

.needs-pie
{
	behavior: url('../../../../Resources/Scripts/PIE.htc');
}

</style>
        <script src="../../Resources/prettify/run_prettify.js">
        </script>
        <script src="../../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../../../Default.htm#Content/API Guide/Upload Writer Programming/UploadMessageMapper.htm">Open topic with navigation</a>
        </p>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix">You are here: </span><a class="MCBreadcrumbsLink" href="../API Guide.htm">API Guides</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="Effective Upload Writer Programming.htm">Upload Writer Programming</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">Upload Message Mapper</span>
        </div>
        <h1>Upload Message Mapper</h1>
        <p>The upload message mapping facility supports rich messaging with support to contextual information that relates to validation and corrections events triggered by transaction validation and corrections by upload data manager.</p>
        <p>This functionality is engaged automatically and the messaging generated out of the box by the <b>com.agencyport.upload.UploadMessageMapper</b> class should suffice most, if not all, requirements. </p>
        <p>There are two options for altering out of the box wording:</p>
        <ul>
            <li value="1">extending/altering the message templates stored in the <b>validation_info</b> resource bundle that are used by the message mapper class following the approved methodologies for changing resource bundle entries.</li>
            <li value="2">Java extension of the product base class.</li>
        </ul>
        <p>The following entries in the <b>validation_info</b> resource bundle meet the various business requirements:</p>
        <table style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/Basic Table Type.css');" class="TableStyle-Basic_Table_Type" cellspacing="0">
            <col class="TableStyle-Basic_Table_Type-Column-Column1" />
            <col class="TableStyle-Basic_Table_Type-Column-Column1" />
            <col class="TableStyle-Basic_Table_Type-Column-Column1" />
            <tbody>
                <tr class="TableStyle-Basic_Table_Type-Body-Body1">
                    <th class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">Resource Bundle Entry Name</th>
                    <th class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">Base Value</th>
                    <th class="TableStyle-Basic_Table_Type-BodyD-Column1-Body1">Designated Purpose</th>
                </tr>
                <tr class="TableStyle-Basic_Table_Type-Body-Body1">
                    <td class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">message.Error.B2B.Required</td>
                    <td class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">${context}, ${field_label} is required</td>
                    <td class="TableStyle-Basic_Table_Type-BodyD-Column1-Body1">Message template for validation oriented events for missing required fields in cases where a related US&#160;state context is not known.</td>
                </tr>
                <tr class="TableStyle-Basic_Table_Type-Body-Body1">
                    <td class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">message.Error.B2B.RequiredForUSState</td>
                    <td class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">${context}, ${field_label} is required in the state of ${USState}</td>
                    <td class="TableStyle-Basic_Table_Type-BodyD-Column1-Body1">Message template for validation oriented events for missing required fields in cases where a related US&#160;state context is known.</td>
                </tr>
                <tr class="TableStyle-Basic_Table_Type-Body-Body1">
                    <td class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">message.Error.B2B.FieldUnknown</td>
                    <td class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">${context}, ${message}</td>
                    <td class="TableStyle-Basic_Table_Type-BodyD-Column1-Body1">
                        <p>Message template for validation oriented events when a discreet field element is not available.</p>
                        <table style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/Note Table.css');" class="TableStyle-Note_Table" cellspacing="0">
                            <col class="TableStyle-Note_Table-Column-Column1" />
                            <tbody>
                                <tr class="TableStyle-Note_Table-Body-Body1">
                                    <td class="TableStyle-Note_Table-BodyA-Column1-Body1">
                                        <p class="noteheader">NOTE:</p>
                                        <p class="note">Many XarcRules will not have a related field element.</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                </tr>
                <tr class="TableStyle-Basic_Table_Type-Body-Body1">
                    <td class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">message.Error.B2B.Invalid</td>
                    <td class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">${context}, ${field_value} is not a valid value for ${field_label}</td>
                    <td class="TableStyle-Basic_Table_Type-BodyD-Column1-Body1">Message template for validation oriented events for an invalid field value in cases where a related US&#160;state context is not known.</td>
                </tr>
                <tr class="TableStyle-Basic_Table_Type-Body-Body1">
                    <td class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">message.Error.B2B.InvalidForUSState</td>
                    <td class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">${context}, ${field_value} is not a valid value for ${field_label} for the state of ${USState}</td>
                    <td class="TableStyle-Basic_Table_Type-BodyD-Column1-Body1">Message template for validation oriented events for an invalid field value in cases where a related US&#160;state context is known.</td>
                </tr>
                <tr class="TableStyle-Basic_Table_Type-Body-Body1">
                    <td class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">message.Correction.B2B.FieldRemoved</td>
                    <td class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">${context}, ${previous_field_value} for the field ${field_label} was removed. ${message}</td>
                    <td class="TableStyle-Basic_Table_Type-BodyD-Column1-Body1">Message template for correction oriented events that remove a field value in cases where a related US&#160;state context is not known.</td>
                </tr>
                <tr class="TableStyle-Basic_Table_Type-Body-Body1">
                    <td class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">message.Correction.B2B.FieldChanged</td>
                    <td class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">${context}, ${previous_field_value} for the field ${field_label} was changed to ${field_value}. ${message}</td>
                    <td class="TableStyle-Basic_Table_Type-BodyD-Column1-Body1">Message template for correction oriented events that changed a field value in cases where a related US&#160;state context is not known.</td>
                </tr>
                <tr class="TableStyle-Basic_Table_Type-Body-Body1">
                    <td class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">message.Correction.B2B.FieldRemovedForUSState</td>
                    <td class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">${context}, ${previous_field_value} for the field ${field_label} for the state of ${USState} was removed. ${message}</td>
                    <td class="TableStyle-Basic_Table_Type-BodyD-Column1-Body1">Message template for correction oriented events that changed a field value in cases where a related US state context is not known.</td>
                </tr>
                <tr class="TableStyle-Basic_Table_Type-Body-Body1">
                    <td class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">message.Correction.B2B.FieldChangedForUSState</td>
                    <td class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">${context}, ${previous_field_value} for the field ${field_label} for the state of ${USState} was changed to ${field_value}. ${message}</td>
                    <td class="TableStyle-Basic_Table_Type-BodyD-Column1-Body1">Message template for correction oriented events that changed a field value in cases where a related US&#160;state context is known.</td>
                </tr>
                <tr class="TableStyle-Basic_Table_Type-Body-Body1">
                    <td class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">message.Context.B2B.Location</td>
                    <td class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">Location</td>
                    <td class="TableStyle-Basic_Table_Type-BodyD-Column1-Body1">When "context" can be supplemented with an additional Location context, this is the localization of the term "Location"</td>
                </tr>
                <tr class="TableStyle-Basic_Table_Type-Body-Body1">
                    <td class="TableStyle-Basic_Table_Type-BodyB-Column1-Body1">message.Context.B2B.EmptyOrNullField</td>
                    <td class="TableStyle-Basic_Table_Type-BodyB-Column1-Body1">null</td>
                    <td class="TableStyle-Basic_Table_Type-BodyA-Column1-Body1">Localization of the term used to convey a field value of empty or null</td>
                </tr>
            </tbody>
        </table>
        <p>All of the entries follow the pattern <b>message.*.B2B.*.</b> The particular message template used for a particular validation or correction event is selected based on the following criteria:</p>
        <ul>
            <li value="1">is the vent a validation or a correction?</li>
            <li value="2">if it is a validation, does the vent have a field element associated with the error?</li>
            <li value="3">if it is a validation, is a required field missing or an invalid data value?</li>
            <li value="4">is the data value on the vent related to a US state?</li>
            <li value="5">if it is a correction, does it reflect a data value removal or alteration?</li>
        </ul>
        <p>The selection algorithm for determining which message template to use for the validation contextual message is provided by the following method:</p>
        <p><i>String <b>getMessageTemplate</b>(ValidationMapperParameters parameters);</i>
        </p>
        <p>While the one supporting correction events is the following:</p>
        <p><i>String <b>getMessageTemplate</b>(CorrectionMapperParameters parameters);</i>
        </p>
        <p>The out of the box message templates contain several substitutable variables, each served up by a discreet <b>UploadMessageMapper</b> protected method. If the out of the box selection criterion needs to be expanded or altered, you must override either or both of the <i style="font-weight: bold;">getMessageTemplate()</i> methods and provide your own algorithm. The following is the list of the out of the box substitutable variables:</p>
        <table style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/Basic Table Type.css');" class="TableStyle-Basic_Table_Type" cellspacing="0">
            <col class="TableStyle-Basic_Table_Type-Column-Column1" />
            <col class="TableStyle-Basic_Table_Type-Column-Column1" />
            <col class="TableStyle-Basic_Table_Type-Column-Column1" />
            <tbody>
                <tr class="TableStyle-Basic_Table_Type-Body-Body1">
                    <th class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">Substitutable Variable</th>
                    <th class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">Default Value</th>
                    <th class="TableStyle-Basic_Table_Type-BodyD-Column1-Body1">Protected UploadMessageMapper method(s) which serves up value</th>
                </tr>
                <tr class="TableStyle-Basic_Table_Type-Body-Body1">
                    <td class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">context</td>
                    <td class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">Derived only for validations and corrections that occur on entities that are configured on roster pages. The roster title, typically configured in the plural, is "singularized" [via protected method <i><b>makeSingular</b>(String, Locale)</i>]. Additional location context may be mapped into the resultant value based on the return value of the protected method <i>Index <b>getRelatedLocationAggregateIndex</b>(MapperParameters)</i>. For scalar atomic fields, this variable is converted to an empty string ("").</td>
                    <td class="TableStyle-Basic_Table_Type-BodyD-Column1-Body1">
                        <ul>
                            <li value="1">String <i style="font-weight: bold;">getContext</i>(ValidationMapperParameters parameters);</li>
                            <li value="2">String <i style="font-weight: bold;">getContext</i>(CorrectionMapperParameters parameters);</li>
                            <li value="3">String <i style="font-weight: bold;">getContext</i>(Page page, MapperParameters parameters); is the core algorithm that both the validation and correction variants delegate to internally.</li>
                        </ul>
                    </td>
                </tr>
                <tr class="TableStyle-Basic_Table_Type-Body-Body1">
                    <td class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">message</td>
                    <td class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">Sourced from the original message text associated with the originating validation or correction event.</td>
                    <td class="TableStyle-Basic_Table_Type-BodyD-Column1-Body1">
                        <ul>
                            <li style="font-style: italic;" value="1">String <b>getValidationMessage</b>(ValidationMapperParameters parameters);</li>
                            <li style="font-style: italic;" value="2">String <b>getCorrectionmessage</b>(CorrectionMapperParameters parameters)</li>
                        </ul>
                    </td>
                </tr>
                <tr class="TableStyle-Basic_Table_Type-Body-Body1">
                    <td class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">field_label</td>
                    <td class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">Sourced from original field label associated with the originating validation or correction event.</td>
                    <td class="TableStyle-Basic_Table_Type-BodyD-Column1-Body1">
                        <ul>
                            <li style="font-style: italic;" value="1">String <b>getFieldLabel</b>(ValidationMapperParameters parameters);</li>
                            <li style="font-style: italic;" value="2">String <b>getFieldLabel</b>(CorrectionMapperParameters parameters)</li>
                        </ul>
                    </td>
                </tr>
                <tr class="TableStyle-Basic_Table_Type-Body-Body1">
                    <td class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">field_value</td>
                    <td class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">Specifically, the current field value associated with the event. This is sourced from the current field value associated with the validation or correction event.</td>
                    <td class="TableStyle-Basic_Table_Type-BodyD-Column1-Body1">
                        <ul>
                            <li style="font-style: italic;" value="1">String <b>getFieldValue</b>(ValidationMapperParameters parameters);</li>
                            <li style="font-style: italic;" value="2">String <b>getFieldValue</b>(CorrectionMapperParameters parameters);</li>
                        </ul>
                    </td>
                </tr>
                <tr class="TableStyle-Basic_Table_Type-Body-Body1">
                    <td class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">previous_field_value</td>
                    <td class="TableStyle-Basic_Table_Type-BodyE-Column1-Body1">Applies to correction events only when an alteration (not a removal) to a data value occurs. This is sourced from the previous field value associated with the correction event.</td>
                    <td class="TableStyle-Basic_Table_Type-BodyD-Column1-Body1"><i>String <b>getPreviousFieldValue</b>(CorrectionMapperParameters parameters);</i>
                    </td>
                </tr>
                <tr class="TableStyle-Basic_Table_Type-Body-Body1">
                    <td class="TableStyle-Basic_Table_Type-BodyB-Column1-Body1">USState</td>
                    <td class="TableStyle-Basic_Table_Type-BodyB-Column1-Body1">
                        <p>Applies to repeating data (roster based) events for both validation or correction events. By using the roster source, the base algorithm will try to find relevant StateProvCd elements for these candidates:</p>
                        <ul>
                            <li value="1">WorkCompLineBusiness.WorkCompRateState</li>
                            <li value="2">CommlAutoLineBusiness.CommlRateState</li>
                            <li value="3">WorkCompLineBusiness.WorkCompIndividuals</li>
                            <li value="4">CommlInlandMarineLineBusiness.CommlIMInfo</li>
                        </ul>
                        <p>Additionally, if the roster source has a <i>LocationRef</i> non null value, the algorithm will attempt to crawl to the related location aggregate and extract the StateProvCd accordingly.</p>
                    </td>
                    <td class="TableStyle-Basic_Table_Type-BodyA-Column1-Body1"><i>String <b>getUSState</b>(MapperParameters parameters);</i> (same method for both validation and correction events)</td>
                </tr>
            </tbody>
        </table>
        <p>A placeholder method, <i>void <b>getCustomProperties</b>(String messageTemplate, Properties properties, MapperParameters parameters)</i> is provided if additional substitutable variables are needed to map to the properties map as the resultant message is rendering.</p>
        <p>If you determine a need to extend one or more of the <b>com.agencyport.upload.UploadMessageMapper</b> methods (option 2), the construction mechanism uses a factory design pattern where the name of the application extension is registered in the application properties. Applications can register a single extension that will handle all LOBs flowing through upload data manager or they can opt to have a discreet extension for each LOB. The static factory method <i>UploadMessageMapper <b>create</b>(AgencyConnectConversionStepData, Object)</i> on the UploadMessageMapper class is invoked by the UploadDataManager constructor. This factory method requires your extension to implement the constructor variant that accepts a com.agencyport.connect.conversion.distributed.</p>
        <p>AgencyConnectConversionStepData followed by a java.lang.Object parameter. The following is an example:</p>
        <table style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/Example Table.css');" class="TableStyle-Example_Table" cellspacing="0">
            <col class="TableStyle-Example_Table-Column-Column1" />
            <tbody>
                <tr class="TableStyle-Example_Table-Body-Body1">
                    <td class="TableStyle-Example_Table-BodyA-Column1-Body1">
                        <p class="exampleheader">EXAMPLE:</p><pre class="prettyprint"><p class="example">public class MyMapper extends UploadMessageMapper {
		public MyMapper(AgencyConnectConversionStepData agencyConnectStepData, 
					Object messageOriginator) {
				super(agencyConnectStepData, messageOriginator);
		}
		protected String normalizeMessage(ValidationMapperParameters parameters){
				return super.normalizeMessage(parameters); 
		}
};</p></pre>
                    </td>
                </tr>
            </tbody>
        </table>
        <p>Supporting application property configuration follows:</p>
        <p><code># Single extension for entire application application.upload_message_mapper_class_name=com.carrier.upload.MyMapper</code>
        </p>
        <p><code># Specific extension for Workers Comp based transactions WORK.upload_message_mapper_class_name=com.carrier.upload.MyMapper</code>
        </p>
        <p>If there are no *.upload_message_mapper_class_name entries, then the base UploadMessageMapper class is used.</p>
        <div class="buttons inline-buttons clearfix topicToolbarProxy" style="mc-topic-toolbar-items: ;">
            <div class="button-group-container-left">
                <button class="button needs-pie previous-topic-button" type="button" title="Navigate previous">
                    <img src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="previous topic" />
                </button>
                <div class="button current-topic-index-button disabled"><span class="sequence-index"></span> of <span class="sequence-total"></span></div>
                <button class="button needs-pie next-topic-button" type="button" title="Navigate next">
                    <img src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="next topic" />
                </button>
            </div>
        </div>
    </body>
</html>