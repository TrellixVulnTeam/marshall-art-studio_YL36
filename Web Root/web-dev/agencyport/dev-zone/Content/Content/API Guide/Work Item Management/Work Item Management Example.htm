<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="Default.xml" data-mc-path-to-help-system="../../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="API Guides|Work Item Management">
    <!-- saved from url=(0016)http://localhost -->
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Work Item Management Example</title>
        <link href="../../../Resources/TableStyles/Example Table.css" rel="stylesheet" />
        <link href="../../../Resources/TableStyles/Tip Table.css" rel="stylesheet" />
        <link href="../../../Resources/TableStyles/Best Practice Table.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/NewStylesheet.css" rel="stylesheet" />
        <style>/*&lt;meta /&gt;*/

.button.previous-topic-button
{
	-pie-background: #f7f7f8 url('file://vmware-host/Shared Folders/Documents/My Projects/AgencyPortal 5.0/Output/Jami_Delia/Online Output/Website Output/Skins/Default/Stylesheets/Images/left-arrow.png') no-repeat center center;
}

.button.current-topic-index-button
{
	-pie-background: linear-gradient(#ffffff, #ffffff);
}

.button.next-topic-button
{
	-pie-background: #f7f7f8 url('file://vmware-host/Shared Folders/Documents/My Projects/AgencyPortal 5.0/Output/Jami_Delia/Online Output/Website Output/Skins/Default/Stylesheets/Images/right-arrow.png') no-repeat center center;
}

.needs-pie
{
	behavior: url('../../../../Resources/Scripts/PIE.htc');
}

</style>
        <script src="../../Resources/prettify/run_prettify.js">
        </script>
        <script src="../../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../../../Default.htm#Content/API Guide/Work Item Management/Work Item Management Example.htm">Open topic with navigation</a>
        </p>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix">You are here: </span><a class="MCBreadcrumbsLink" href="../API Guide.htm">API Guides</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="Work Item Management.htm">Work Item Management</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">Work Item Management Example</span>
        </div>
        <h1>Work Item Management Example</h1>
        <p>New applications should start with a clean slate regarding the work item data model and align with the single work item table model. It is customary to add one or more columns to the work item for the purposes of enhancing an application's work list and/or workflow. The example shown on this page adds two columns to the work item table and illustrates most effectively how you can leverage existing core functionality without replicating implementation. </p>
        <h2>Extending the DDL</h2>
        <p>In this example, two columns are added to the work item: a work item description field and a copy_source_id field, which tracks the work item id from the current work item cloned in a copy work item scenario.</p>
        <table style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/Best Practice Table.css');" class="TableStyle-Best_Practice_Table" cellspacing="0">
            <col class="TableStyle-Best_Practice_Table-Column-Column1" />
            <tbody>
                <tr class="TableStyle-Best_Practice_Table-Body-Body1">
                    <td class="TableStyle-Best_Practice_Table-BodyA-Column1-Body1">
                        <p class="bestpracticeheader">BEST&#160;PRACTICE:</p>
                        <p class="bestpractice">Extend the work_item table's DDL shipped with the product (if necessary) to meet the needs of the application. Append the new custom columns to the end of the existing product's version of the DDL. Do NOT&#160;insert columns.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p>Extend the DDL&#160;for the work item table as follows:</p><pre class="prettyprint"><p>CREATE TABLE work_item
(
work_item_id integer NOT NULL,
user_group_id integer NOT NULL,
creator_id integer NOT NULL,
owner_id integer NOT NULL,
owner_group_id integer NOT NULL,
status integer NOT NULL,
policy_number varchar(25),
LOB varchar(10) NOT NULL,
effective_date ${db_current_date},
expiration_date ${db_current_date},
creation_time ${db_current_time},
entity_name varchar(80),
premium decimal(13,2),
transaction_id varchar(25) NOT NULL,
upload_flag smallint NOT NULL,
last_update_by varchar(${login_id_size}) NOT NULL,
last_update_time ${db_current_time} NOT NULL,
commit_flag smallint NOT NULL,

/* Append custom columns to end per best practice */
description varchar(128),
copy_source_id integer
);</p></pre>
        <h2>Extending the WorkItem Class</h2>
        <table style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/Best Practice Table.css');" class="TableStyle-Best_Practice_Table" cellspacing="0">
            <col class="TableStyle-Best_Practice_Table-Column-Column1" />
            <tbody>
                <tr class="TableStyle-Best_Practice_Table-Body-Body1">
                    <td class="TableStyle-Best_Practice_Table-BodyA-Column1-Body1">
                        <p class="bestpracticeheader">BEST&#160;PRACTICE:</p>
                        <p class="bestpractice">Extend the concrete com.agencyport.workitem.impl.WorkItem class by adding set/get methods for the fields not currently modeled by the base class. Leverage the property map internal to the base class by use of the setPropertyValue/getPropertyValue by name methods. Using the setPropertyValue method manages the dirty flag state of the work item correctly requiring no special code.</p>
                    </td>
                </tr>
            </tbody>
        </table><pre class="prettyprint"><p>/*
 * Created on May 21, 2009 by nbaker AgencyPort Insurance Services, Inc.
 */
package test.agencyport.workitem.impl;
import com.agencyport.id.Id;
import com.agencyport.workitem.impl.WorkItem;
/**
 * The CustomWorkItem class illustrates how the extend the product's work item class
 * to add custom properties. other properties
 */
public class CustomWorkItem extends WorkItem {
    /**
      * The &lt;code&gt;COPY_SOURCE_ID&lt;/code&gt; is the key for the copy source id data value.
      */
    public static final String COPY_SOURCE_ID = &amp;quot;COPY_SOURCE_ID&amp;quot;;
    /**
      * The &lt;code&gt;DESCRIPTION&lt;/code&gt; is the key for the description of the work item.
      */
    public static final String DESCRIPTION = &amp;quot;DESCRIPTION&amp;quot;;
     
    /**
      * Return the source from which this work item was originally based on.
      * @return the source from which this work item was originally based on.
      */
    public Id getCopySourceId(){
		return (Id) getPropertyValue(COPY_SOURCE_ID);
    }
    /**
      * Sets the work item id for the work item this work item was copied from.
      * @param copySourceId is the work item id of the work item this one was copied from.
      */
    public void setCopySourceId(Id copySourceId){
		setPropertyValue(COPY_SOURCE_ID, copySourceId);
    }
    /**
      * Returns the description this work item.
      * @return the description this work item.
      */
    public String getDescription(){
		return (String) getPropertyValue(DESCRIPTION);
    }
    /**
      * Sets the description of this work item.
      * @param description is the description of the work item to set.
      */
    public void setDescription(String description){
		setPropertyValue(DESCRIPTION, description);
    }
     
}</p></pre>
        <h2>Extending the WorkItemManager Class</h2>
        <table style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/Best Practice Table.css');" class="TableStyle-Best_Practice_Table" cellspacing="0">
            <col class="TableStyle-Best_Practice_Table-Column-Column1" />
            <tbody>
                <tr class="TableStyle-Best_Practice_Table-Body-Body1">
                    <td class="TableStyle-Best_Practice_Table-BodyA-Column1-Body1">
                        <p class="bestpracticeheader">BEST&#160;PRACTICE:</p>
                        <p class="bestpractice">Extend the concrete com.agencyport.workitem.impl.WorkItemManager class and only override the following specific methods:</p>
                        <ul>
                            <li value="1">getAdditionalCustomColumnNameList()</li>
                            <li value="2">customInitializeWorkItem()</li>
                            <li value="3">customBindDataToStatement()</li>
                            <li value="4">customMapResultsSetToWorkItem()</li>
                        </ul>
                    </td>
                </tr>
            </tbody>
        </table>
        <table style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/Tip Table.css');" class="TableStyle-Tip_Table" cellspacing="0">
            <col class="TableStyle-Tip_Table-Column-Column1" />
            <tbody>
                <tr class="TableStyle-Tip_Table-Body-Body1">
                    <td class="TableStyle-Tip_Table-BodyA-Column1-Body1">
                        <p class="tipheader">TIP:</p>
                        <p class="tip">In 4.5, there was a change to some of the method signatures that render the following code samples, making them slightly out of date. If your method signatures are out of date, substitute IWorkItem for ILOBWOrkItem.</p>
                        <table style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/Example Table.css');" class="TableStyle-Example_Table" cellspacing="0">
                            <col class="TableStyle-Example_Table-Column-Column1" />
                            <tbody>
                                <tr class="TableStyle-Example_Table-Body-Body1">
                                    <td class="TableStyle-Example_Table-BodyA-Column1-Body1">
                                        <p class="exampleheader">EXAMPLE:</p>
                                        <p class="example">customBindDataToStatement(ILOBWOrkItem workItem, PreparedStatement pStmt, in ordinalOfNextBoundParameter)</p>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                </tr>
            </tbody>
        </table><pre class="prettyprint"><p>/*
 * Created on May 21, 2009 by nbaker AgencyPort Insurance Services, Inc.
 */
package test.agencyport.workitem.impl;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.Map;
import com.agencyport.domXML.APDataCollection;
import com.agencyport.id.Id;
import com.agencyport.security.profile.ISecurityProfile;
import com.agencyport.trandef.Transaction;
import com.agencyport.workitem.impl.WorkItemException;
import com.agencyport.workitem.impl.WorkItemManager;
import com.agencyport.workitem.model.IWorkItem;
import com.agencyport.workitem.model.IWorkItemStatusManager;
/**
 * The CustomWorkItemManager class illustrates how the product's work item manager class can be
 * extended to support the scenario where the application needs to add one or more columns to the work_item table with additional
 * columns appended therein. The restrictions are as follows:
 * &lt;li&gt;All of the columns in the physical work_item table must match the current product's version of the DDL up to the last column which it defines..&lt;/li&gt;
 * &lt;li&gt;The application can only append new columns at the end and not insert new columns.&lt;/li&gt;
 * &lt;li&gt;If the application have additional tables beyond the work_item table which comprises the notion
 * of a work item then this technique will not work. &lt;/li&gt;
 */
public class CustomWorkItemManager extends WorkItemManager {
    private static final String description = &amp;quot;description&amp;quot;;
    private static final String copy_source_id = &amp;quot;copy_source_id&amp;quot;;
    /**
      * The &lt;code&gt;nonKeyColumnNameList&lt;/code&gt; contains all of the non primary
      * key column names in the work item table.
      */
    private static final String[] additionalNonKeyColumnNameList = {
		description,
		copy_source_id
    };
     
    /* (non-Javadoc)
     * @see com.agencyport.workitem.impl.WorkItemManager#getAdditionalCustomColumnNameList()
     */
    @Override
    protected String[] getAdditionalCustomColumnNameList(){
		return additionalNonKeyColumnNameList;
    }
    /* (non-Javadoc)
      * @see com.agencyport.workitem.impl.WorkItemManager#customInitializeWorkItem(com.agencyport.workitem.model.IWorkItem, com.agencyport.domXML.APDataCollection, com.agencyport.trandef.Transaction, com.agencyport.id.Id, com.agencyport.id.Id, java.lang.Boolean, java.lang.Boolean, com.agencyport.security.profile.ISecurityProfile, java.util.Map)
      */
    @Override
    protected void customInitializeWorkItem(IWorkItem newWorkItem, APDataCollection apdata, Transaction transaction,
			Id userId, Id userGroupId, Boolean isUpload,
			Boolean commitFlag, ISecurityProfile securityProfile, Map&lt;?, ?&gt; customAttributes) throws WorkItemException {
		if ( customAttributes == null )
			return;
		CustomWorkItem customWorkItem = (CustomWorkItem) newWorkItem;
		customWorkItem.setCopySourceId((Id) customAttributes.get(CustomWorkItem.COPY_SOURCE_ID));
		customWorkItem.setDescription((String) customAttributes.get(CustomWorkItem.DESCRIPTION));
    }
    /* (non-Javadoc)
     * @see com.agencyport.workitem.impl.WorkItemManager#customBindDataToStatment(com.agencyport.workitem.model.IWorkItem, java.sql.PreparedStatement, int)
     */
    @Override
    protected void customBindDataToStatment(IWorkItem workItem, PreparedStatement pStmt, int ordinalOfNextBoundParameter)
    throws SQLException {
		pStmt.setString(ordinalOfNextBoundParameter, ((CustomWorkItem)workItem).getDescription());
		pStmt.setInt(ordinalOfNextBoundParameter + 1, ((CustomWorkItem)workItem).getCopySourceId().intValue());
     
    }
     
    /* (non-Javadoc)
     * @see com.agencyport.workitem.impl.WorkItemManager#customMapResultSetToWorkItem(com.agencyport.workitem.model.IWorkItem, java.sql.ResultSet, com.agencyport.workitem.model.IWorkItemStatusManager)
     */
    @Override
    protected void customMapResultSetToWorkItem(IWorkItem workItem, ResultSet resultSet, IWorkItemStatusManager workItemStatusManager)
    throws WorkItemException, SQLException {
		((CustomWorkItem)workItem).setDescription(resultSet.getString(description));
		((CustomWorkItem)workItem).setCopySourceId(new Id(resultSet.getInt(copy_source_id)));
    }
     
     
}</p></pre>
        <div class="buttons inline-buttons clearfix topicToolbarProxy" style="mc-topic-toolbar-items: ;">
            <div class="button-group-container-left">
                <button class="button needs-pie previous-topic-button" type="button" title="Navigate previous">
                    <img src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="previous topic" />
                </button>
                <div class="button current-topic-index-button disabled"><span class="sequence-index"></span> of <span class="sequence-total"></span></div>
                <button class="button needs-pie next-topic-button" type="button" title="Navigate next">
                    <img src="../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="next topic" />
                </button>
            </div>
        </div>
    </body>
</html>