// -----------------------------------------------------------------------------------------------------//// GLOBAL VARIABLES// -----------------------------------------------------------------------------------------------------//var menuObj = new Array();var lookupCID = new Array();var menus = null;var asp;var currCID;var URLPrefix = ""defaultL2 = 0;defaultL3 = 0;defaultL4 = 0;var defaultEducation = "bas";var defaultTradersTools = "snaps";var defaultProducts = "pspec";// -----------------------------------------------------------------------------------------------------//// GLOBAL FUNCTIONS// -----------------------------------------------------------------------------------------------------//function CreateMenuObject(string, URL, L2, L3, L4){	if (lookupCID[stripAnchor(URL)] == null)	{		lookupCID[stripAnchor(URL)] = L2 + "," + L3 + "," + L4;	}	lookupCID[URL] = L2 + "," + L3 + "," + L4;	this.string = string;	this.URL = URL;	this.children = null; 	return this;}function OutputL1Menu(){	var education = /education/i;	var traderstools = /traderstools/i;	var products = /products/i;		if (education.test(asp))	{		document.writeln('<td width="87" height="39"><a href="', constructURL(defaultEducation,"education"),'"><img src="images/educ-butnlit.gif" name="education" width="87" height="39" border="0"></a></td>');		document.write('<td width="107" height="39"><a href="', constructURL(defaultTradersTools,"traderstools"), '" onMouseOver="traderstools.src=');		document.write("'images/trad-butnlit.gif'"); document.write('" onMouseOut="'); document.write("traderstools.src='images/trad-butn.gif'");		document.write('"><img src="images/trad-butn.gif" name="traderstools" width="107" height="39" border="0"></td>');		document.write('<td width="71" height="39"><a href="', constructURL(defaultProducts,"products"), '" onMouseOver="products.src=');		document.write("'images/prod-butnlit.gif'"); document.write('" onMouseOut="'); document.write("products.src='images/prod-butn.gif'");		document.write('"><img src="images/prod-butn.gif" name="products" width="71" height="39" border="0"></td>');	}	else if (traderstools.test(asp))	{		document.write('<td width="87" height="39"><a href="', constructURL(defaultEducation,"education"),'" onMouseOver="education.src=');		document.write("'images/educ-butnlit.gif'"); document.write('" onMouseOut="'); document.write("education.src='images/educ-butn.gif'");		document.write('"><img src="images/educ-butn.gif" name="education" width="87" height="39" border="0"></td>');		document.writeln('<td width="107" height="39"><a href="', constructURL(defaultTradersTools,"traderstools"), '"><img src="images/trad-butnlit.gif" name="traderstools" width="107" height="39" border="0"></td>');		document.write('<td width="71" height="39"><a href="', constructURL(defaultProducts,"products"), '" onMouseOver="products.src=');		document.write("'images/prod-butnlit.gif'"); document.write('" onMouseOut="'); document.write("products.src='images/prod-butn.gif'");		document.write('"><img src="images/prod-butn.gif" name="products" width="71" height="39" border="0"></td>');	}	else if (products.test(asp))	{		document.write('<td width="87" height="39"><a href="', constructURL(defaultEducation,"education"),'" onMouseOver="education.src=');		document.write("'images/educ-butnlit.gif'"); document.write('" onMouseOut="'); document.write("education.src='images/educ-butn.gif'");		document.write('"><img src="images/educ-butn.gif" name="education" width="87" height="39" border="0"></td>');		document.write('<td width="107" height="39"><a href="', constructURL(defaultTradersTools,"traderstools"), '" onMouseOver="traderstools.src=');		document.write("'images/trad-butnlit.gif'"); document.write('" onMouseOut="'); document.write("traderstools.src='images/trad-butn.gif'");		document.write('"><img src="images/trad-butn.gif" name="traderstools" width="107" height="39" border="0"></td>');		document.writeln('<td width="71" height="39"><a href="', constructURL(defaultProducts,"products"), '"><img src="images/prod-butnlit.gif" name="products" width="71" height="39" border="0"></td>');	}	else	{		document.write('<td width="87" height="39"><a href="', constructURL(defaultEducation,"education"),'" onMouseOver="education.src=');		document.write("'images/educ-butnlit.gif'"); document.write('" onMouseOut="'); document.write("education.src='images/educ-butn.gif'");		document.write('"><img src="images/educ-butn.gif" name="education" width="87" height="39" border="0"></td>');		document.write('<td width="107" height="39"><a href="', constructURL(defaultTradersTools,"traderstools"), '" onMouseOver="traderstools.src=');		document.write("'images/trad-butnlit.gif'"); document.write('" onMouseOut="'); document.write("traderstools.src='images/trad-butn.gif'");		document.write('"><img src="images/trad-butn.gif" name="traderstools" width="107" height="39" border="0"></td>');		document.write('<td width="71" height="39"><a href="', constructURL(defaultProducts,"products"), '" onMouseOver="products.src=');		document.write("'images/prod-butnlit.gif'"); document.write('" onMouseOut="'); document.write("products.src='images/prod-butn.gif'");		document.write('"><img src="images/prod-butn.gif" name="products" width="71" height="39" border="0"></td>');	}	return true;}function OutputL2Menu(){	var i = 0;	for (i = 0; i < menuObj.length; i++)	{		if (i == 6)		{			document.write("<br>");		}		if (i == menus[0])		{			document.writeln('<a href="', constructURL(menuObj[i].URL, asp), '" class="L2entrySel">&nbsp;&nbsp;', menuObj[i].string, '&nbsp;&nbsp;</a>');		}		else		{			document.writeln('&nbsp;<a href="', constructURL(menuObj[i].URL, asp), '" class="L2entry">', menuObj[i].string, '</a>&nbsp;');		}	}	return true;}function OutputL3Menu(){	var i = 0;	var L2 = menus[0];	var L3 = menus[1];	var currmenu = menuObj[L2].children;		if (currmenu != null)	{		document.writeln("<TR valign=top height=100%><TD bgcolor=#eeeefa class=miscl><br>");		for (i = 0; i < currmenu.length; i++)		{			if (i == L3)			{				document.writeln('</td></tr><tr valign=top><td bgcolor=#cdd4e3 class=L3entry>', currmenu[i].string, '</td></tr>');				OutputL4Menu();			}			else			{				document.writeln('<a class=L3entry href="', constructURL(currmenu[i].URL, asp), '">', currmenu[i].string, '</a><br><br>');			}		}		document.writeln("</td></tr>");	}}function OutputL4Menu(){	var i = 0;	var L2 = menus[0];	var L3 = menus[1];	var L4 = menus[2];	var currmenu = menuObj[L2].children[L3].children;	var anchorString;		if (currmenu != null)	{		anchorString = checkMenu(currmenu);		if (anchorString.length > 0)		{			document.writeln("<tr><td bgcolor=white class=l4entryAnchor align=left valign=top><br>");			document.writeln("<table border=0 cellspacing=0 cellpadding=0>");			for (i = 0; i < currmenu.length; i++)			{					if (anchorString.indexOf(i) != -1)				{					document.writeln('<tr><td width="10" valign="top"><img src="images/arrow-down-drooprw.gif" width="10" height="11" border="0"></td><td align="left">');				}				else				{					document.writeln('<tr><td colspan="2">');				}				document.writeln('<a class=L4entry href="', constructURL(currmenu[i].URL, asp), '">', currmenu[i].string, '</a><br><br></td></tr>');			}		}		else		{			document.writeln("</td></tr><tr><td bgcolor=#eeeefa class=l4entry align=right valign=top><br>");			document.writeln("<table border=0 cellspacing=0 cellpadding=0>");			for (i = 0; i < currmenu.length; i++)			{					if (i == L4)				{					document.writeln('<tr><td align=right><a class=L4entrySel href="', constructURL(currmenu[i].URL, asp), '">', currmenu[i].string, '</a><br><br></td></tr>');				}				else				{					document.writeln('<tr><td align=right><a class=L4entry href="', constructURL(currmenu[i].URL, asp), '">', currmenu[i].string, '</a><br><br></td></tr>');				}			}		}		document.writeln("</table>");		document.writeln("</td></tr><tr valign=top height=100%><TD bgcolor=#eeeefa class=miscl><br>");	}	else	{		document.writeln("<tr valign=top><td bgcolor=#eeeefa><br>");	}}function checkURL(URL){	var temp1 = URL.indexOf("#");	if (temp1 != -1)	{		return true;	}		else	{		return false;		}}function stripAnchor(URL){	var temp = URL.indexOf("#");	if (temp != -1)	{		return URL.substring(0,temp);	}		return URL;}function checkMenu(menuObj){	var currMenu = stripAnchor(currCID);	var indexString = "";	for (var i = 0; i < menuObj.length; i++)	{		if ( (checkURL(menuObj[i].URL)) && (stripAnchor(menuObj[i].URL) == currMenu) )		{			indexString = indexString + i + ":";		}	}	if (indexString.length > 0)	{		return indexString.substring(0,indexString.length - 1);	}	else	{		return indexString;	}}				function parseURL(URL){	var contentidregexp = /.*cid\=(.+)$/ig;	var results;	var i = 0;	L1Menu = null;	L2Menu = null;	L3Menu = null;	L4Menu = null;	results = contentidregexp.exec(URL);	if (results != null)	{		lookup(results[1]);		currCID = results[1];	}	else	{		lookup("");	}}function lookup(CID){	var str;	var i;	str = lookupCID[CID];		// If we don't find the CID, set default values	if (str == null)	{		menus = new Array(3);		menus[0] = defaultL2;		menus[1] = defaultL3;		menus[2] = defaultL4;		currCID = menuObj[defaultL2].URL;	}	else	{		menus = str.split(",");	}}function addPageIDs(menuString, idString){	var pageIDs = idString.split(",");	for (var i = 0; i < pageIDs.length; i++)	{		lookupCID[pageIDs[i]] = menuString;	}	}function constructURL(URL, aspFile){	var http = /^http:\/\//ig;	if (!(http.test(URL)))	{		return URLPrefix + aspFile + ".asp?cid=" + URL;	}	else	{		return URL;	}}